
**3. 전이학습 기반 소재(물성) 대응 FDM 공정 품질 예측 모델 개발**

---

**3.1 AI 기반 소스 도메인 소재에 대한 사전학습 모델 개발**

### 1. 모델의 선택: 인공 신경망 (ANN)
3D 프린팅 출력물의 물리적 특성 예측에는 인공 신경망(ANN) 모델이 적합하다고 판단되었다. ANN은 순전파 및 역전파 학습 알고리즘을 활용하여 복잡한 데이터 패턴을 효과적으로 학습할 수 있다. 특히 재료의 물성 데이터와 3D 프린팅 파라미터 간의 관계가 비선형 및 복잡한 패턴을 포함하고 있기 때문에 ANN을 선택하였다.

### 2. 하이퍼 파라미터 및 아키텍처 조정
적절한 하이퍼 파라미터 조정과 깊은 모델 아키텍처는 ANN 모델의 성능 향상에 중요하다. 그리드 서치를 활용하여 다양한 하이퍼 파라미터 조합을 시도하며 최적의 모델을 찾는 과정을 진행하였다.

### 3. ANN 모델 아키텍처
- **입력 레이어:** 재료의 물성 데이터와 3D 프린팅 파라미터를 포함한다. 다양한 입력 데이터 특성을 고려하여 모델 학습에 활용된다.
  
- **은닉 레이어:** 총 3개의 은닉 레이어를 구성하였고, ReLU 활성화 함수를 통해 모델에 비선형성을 주입하였다. 각 은닉 레이어의 뉴런 수는 N1, N2, N3로 조정되었다. 이렇게 설정한 뉴런 수는 모델의 복잡성 및 학습 성능을 균형 있게 유지하기 위함이다.
  
### 4. 예측 성능 및 적용
이렇게 개발된 ANN 모델인 ANN-B는 ABS 및 PLA 출력물의 물성치와 프린팅 파라미터를 입력값으로 활용하여 Tensile Strength(MPa), Dimensional error(%), Weight(g) 등의 실험 데이터를 효과적으로 예측하였다. 모델은 순전파와 역전파 학습 알고리즘을 통해 데이터의 패턴을 성공적으로 학습하였다.

**입력 파라미터**
- 소재 물성 데이터: 
    1. Density(g/cm^3)
    2. Thermal Resistance(W/mK)
    3. Impact Strength(J/m)
    4. Glass Transition Temperature(℃)
    5. Thermal conductivity(W/mK)
    6. Linear Thermal Expansion Coefficient(1/K)
- 3D 프린팅파라미터:
    1. Bed temperature(℃)
    2. Extruder temperature(℃)
    3. Layer Thickness(mm)

**아웃풋 파라미터**
1. Tensile Strength(MPa)
2. Dimensional error(%)
3. Weight(g)

학습 및 테스트 데이터셋은 ABS 및 PLA 출력물의 270개의 실험 데이터를 기반으로 설정하였으며, 전체 데이터 중 10%를 검증 세트로 사용하였다. 모델 최적화를 위한 하이퍼 파라미터 튜닝은 그리드 서치 방법을 활용하여 진행하였다. 선택된 하이퍼 파라미터는 Learning rate(0.001, 0.005, 0.01), N1(20, 30, 40), N2(10, 20, 30), 그리고 N3(5, 10, 15, 20)였다. 총 108개의 케이스에 대한 그리드 서치 결과, Learning rate=0.01, N1=30, N2=30, N3=10인 모델이 가장 우수한 성능을 보였다. 이 모델은 10000 epoch 학습을 통해 검증 오차 3.60%를 달성하였으며, 이는 향후 전이학습을 통해 PETG 출력물의 품질 예측에 활용될 것이다.

**3.2 전이학습 기반 타겟 도메인 소재에 대한 품질 예측 모델 개발**

사전 학습된 ABS 및 PLA 품질 예측 모델인 ANN-B를 기반으로 PETG 출력물의 품질 예측을 위한 전이학습 기반의 모델을 개발하였다. 이 모델은 기존 모델의 구조와 학습된 가중치를 기반으로 하였으며, 추가 학습을 통해 PETG에 특화된 품질 예측 성능을 향상시켰다.

모델의 성능 평가는 다양한 학습 데이터 조건에서 진행되었다. 전이 학습은 학습 데이터셋에 따라 ANN-T1, ANN-T2 2가지 종류로 나누어 각각 진행하였다. 두 모델은 전체 PETG 실험 데이터셋의 1/3씩을 서로 중복되지 않도록 각각 학습한 모델이며, 검증 데이터셋은 이 모델들에서 학습하지 않은 나머지 1/3을 사용하였다. 이렇게 설정된 학습 및 테스트 데이터는 전이학습의 효과를 확인하기 위함이다.

ANN-T1과 ANN-T2를 ANN-B* 모델과 비교함으로써, 전이학습의 효과를 확인하였다. ANN-B*는 전체 PETG 실험 데이터셋을 기반으로 학습한 모델이다. 이 모델은 전이학습을 활용하지 않고 PETG 데이터셋의 2/3을 학습하고 1/3을 검증 데이터셋으로 사용한 모델로, 전이학습을 활용한 ANN-T1과 ANN-T2 모델과의 성능 비교를 통해 전이학습의 효과를 확인하였다.


**3.3 모델 성능 결과 비교**
개발된 모델들의 성능을 비교하기 위해, 3.1의 모델에서 PETG 데이터 테스트 결과와 전이학습 모델을 활용한 PETG 데이터 테스트 결과를 비교하였다. 결과적으로 전이학습을 활용한 모델이 더 우수한 예측 성능을 보였으며, 이를 통해 소재의 물성을 기반으로 한 3D 프린팅 출력물의 품질 예측에 전이학습이 효과적임을 확인하였다.

















```데이터
# ANN 모델 구조
ANN 모델은 입력 데이터를 통해 순전파(forward propagation) 및 역전파(backpropagation) 학습 알고리즘을 사용하여 가중치와 편향을 조정하며 데이터의 패턴을 학습한다. 이러한 모델을 깊게 쌓는 것(딥러닝)은 더 복잡한 문제에 대한 해결을 가능하게 한다. 각 레이어의 뉴런 수를 조정하거나, 레이어의 수를 조정하는 등의 방법으로 모델의 구조를 변경할 수 있다. 이번 프로젝트에서는 3개의 은닉 레이어를 사용하였다. 각 레이어의 뉴런 수를 조정하고, 레이어의 수를 조정하여 모델의 구조를 변경하였다. 또한, 학습 알고리즘의 하이퍼 파라미터를 조정하여 최적의 모델을 찾았다.

## 학습 데이터
- ABS, PLA 출력물의 물성치 및 프린팅 파라미터를 입력값으로 설정하여 나온 Tensile Strength(MPa), Dimensional error(%), Weight(g) 실험 데이터
- Validation set: 10%


## 하이퍼 파라미터
- Full batch learning
- Epoch: 10000
- Early stopping: 1000
- 그리드 서치 하이퍼 파라미터
    - Learning rate: 0.001, 0.005, 0.01 
    - N1: 20, 30, 40
    - N2: 10, 20, 30
    - N3: 5, 10, 15, 20

## Loss
단위가 다른 3개의 출력물 특성을 예측하는 모델이므로, 각 출력물 특성에 대한 loss를 따로 계산하여 총 loss를 구합니다. 각 출력물 특성에 대한 loss는 다음과 같습니다. 각 loss에는 동일 가중치를 부여합니다.
- Dimensional error(%): MAE
- Tensile Strength(MPa): MAPE
- Weight(g): MAPE

## Optimizer
- Adam optimizer 사용

### 입력 레이어 (Input Layer)
- 재료의 물성 데이터(6개) + 3D프린팅파라미터(3개)
    - 물성 데이터
        1. Density(g/cm^3)
        2. Thermal Resistance(W/mK)
        3. Impact Strength(J/m)
        4. Glass Transition Temperature(℃)
        5. Thermal conductivity(W/mK)
        6. Linear Thermal Expansion Coefficient(1/K)
    - 3D프린팅파라미터
        1. Bed temperature(℃)
        2. Extruder temperature(℃)
        1. Layer Thickness(mm)

 - shape: (Batch_size, 9)

### 은닉 레이어 (Hidden Layers):
- 총 3개의 은닉 레이어를 사용
- Activation function: ReLU
- 각 은닉 레이어의 뉴런 수를 N1, N2, N3라고 하면, 각 레이어의 shape은 다음과 같음
    - shape: (Batch_size, N1)
    - shape: (Batch_size, N2)
    - shape: (Batch_size, N3)

### 출력 레이어 (Output Layer):
- 3개의 출력물 특성 예측
    1. Tensile Strength(MPa)
    2. Dimensional error(%)
    3. Weight(g)
- Activation function: ReLU
- shape: (Batch_size, 3)
```

```작성 가이드
1. 서론
   - 공정에 대한 개념, 산업적인 측면에서 어떤 강점이 있고 어떤 분야에 적용되고 있는지
   - 본 장비 관련해서 어떤 연구들이 진행되고 있는지(우리가 주장하고자 하는 소재 대응 관련 내용 중심으로 탐색)
   - 해당 연구들에서의 한계가 무엇인지(우리가 주장하고자 하는 소재 대응 관점에서의 한계 중심으로 서술)
   - 그래서 본 연구에서 어떤 연구를 진행하고자 하는지
2. FDM 공정 데이터 수집 및 분석
2.1 실험 환경
- 실험 장비명, 사진, 셋업 환경 등
2.2 실험 소재
- 활용한 소재 각각에 대한 기본 설명 
- 해당 소재를 선정한 근거 및 이유 등 본 연구의 타당성을 뒷받침 할 수 있는 내용 포함하여 서술
2.3 공정 데이터 수집
- 본실험 데이터 중심 서술
- 실험 조건, 수집 데이터, 데이터 수집 방법(치수 측정, 인장강도 수집 장비 및 방법 등), 데이터 수집 결과 등
2.4 데이터 분석
- 주효과도 분석(및 교호작용도) 수행 결과
- AI 기반 소재(물성) 대응 공정 최적화 모델의 개발 필요성으로 이어지게 흐름을 유도하면 더 좋을 듯
3. 전이학습 기반 소재(물성) 대응 FDM 공정 품질 예측 모델 개발 
3.1 AI 기반 소스 도메인 소재에 대한 사전학습 모델 개발
- ABS + PLA 품질 예측 모델 개발 내용(인풋 파라미터, 아웃풋 파라미터, 학습/테스트 데이터 셋, 파라미터 튜닝 결과, 모델 성능 결과)
- ANN, CNN 등 여러 모델 개발했다면 각각에 대한 내용 서술 후 더 성능이 좋은 1개 모델 선정하였다는 방향으로(이 경우 그래프나 표로 비교할 수 있게 자료 삽입)
3.2 전이학습 기반 타겟 도메인 소재에 대한 품질 예측 모델 개발
    - 사전학습 모델 기반 PETG 품질 예측 모델 개발 내용
    - 모델 성능 평가 및 최종 구조 선정 -> 학습 데이터 수 train: 1cycle vs 2cycle / test: 제3의 1cycle
    - (인풋 파라미터, 아웃풋 파라미터, 모델 구조, 모델 구조 선정 과정, 학습/테스트 데이터 셋, 파라미터 튜닝 결과, 모델 성능 결과 등 포함)
3.3 모델 성능 결과 비교
    - 3.1, 3.2에서 개발한 모델 중심으로 모델 성능 결과 비교 및 최종 선정 모델 서술
      --> ① 3.1 모델에서의 PETG 데이터 테스트 결과
      --> ② 전이학습 모델 활용 PETG 데이터 테스트 결과 
    - 각 모델별 성능 결과를 가시적(직관적)으로 확인할 수 있도록 그래프 추출
4. AI 기반 소재(물성) 대응 FDM 공정 최적화 모델 개발 <<< 상황에 따라 추가 작성(내일 논의 후 고려)
5. 결론
```